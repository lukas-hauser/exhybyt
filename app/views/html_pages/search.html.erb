<% provide(:title, 'Find Space') %>

<div class="row">
  <div class="col-md-6">
    <%= search_form_for @search, url: search_path do |f| %>

      <div class="row">
        <div class="col">
          <div class="form-group">
            <%= text_field_tag :start_date, params[:start_date], placeholder: "Start Date", class:"form-control" %>
          </div>
        </div>

        <div class="col">
          <div class="form-group">
            <%= text_field_tag :end_date, params[:end_date], placeholder: "End Date", class:"form-control" %>
          </div>
        </div>
      </div>

      <div class="form-group">
        <%= f.select :category_eq, space_categories, { prompt: "Space Category" }, class: "form-control custom-select" %>
      </div>

      <div class="form-group">
        <%= f.select :venue_type_eq, venue_types, { prompt: "Venue Type" }, class: "form-control custom-select" %>
      </div>

      <div class="row">
        <div class="col">
          <div class="form-group">
            <%= f.text_field :price_gteq, placeholder: "Min Price", class:"form-control" %>
          </div>
        </div>
        <div class="col">
          <div class="form-group">
            <%= f.text_field :price_lteq, placeholder: "Max Price", class:"form-control" %>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col">
          <div class="mb-3">
            <label for="wall_width">Minimum Wall Space Width</label>
            <div class="input-group mb-3">
              <div class="input-group-prepend">
                <span class="input-group-text" id="basic-addon1">cm</span>
              </div>
              <%= f.text_field :wall_width_gteq, placeholder: "e.g. 40", class: "form-control" %>
            </div>
          </div>
        </div>
        <div class="col">
          <div class="mb-3">
            <label for="wall_height">Min. Height</label>
            <div class="input-group mb-3">
              <div class="input-group-prepend"">
                <span class="input-group-text" id="basic-addon2">cm</span>
              </div>
              <%= f.text_field :wall_height_gteq, placeholder: "e.g. 40", class: "form-control" %>
            </div>
          </div>
        </div>
      </div>

      <hr class="my-4">

      <h5>Amenities:</h5>

      <div class="row">
        <div class="col">
          <div class="form-check">
            <%= check_box_tag 'q[is_adj_light_eq]', true %> Adjustable Lighting
          </div>

          <div class="form-check">
            <%= check_box_tag 'q[is_dis_acc_eq]', true %> Disabled Access
          </div>

          <div class="form-check">
            <%= check_box_tag 'q[is_hang_sys_eq]', true %> Hanging System
          </div>

          <div class="form-check">
            <%= check_box_tag 'q[is_nat_light_eq]', true %> Natural Light
          </div>

          <div class="form-check">
            <%= check_box_tag 'q[is_parking_eq]', true %> Parking
          </div>
        </div>
        <div class="col">
          <div class="form-check">
            <%= check_box_tag 'q[is_plugs_eq]', true %> Power Plugs
          </div>

          <div class="form-check">
            <%= check_box_tag 'q[is_sec_sys_eq]', true %> Security System
          </div>

          <div class="form-check">
            <%= check_box_tag 'q[is_storage_eq]', true %> Storage
          </div>

          <div class="form-check">
            <%= check_box_tag 'q[is_toilet_eq]', true %> Toilet
          </div>

          <div class="form-check">
            <%= check_box_tag 'q[is_wifi_eq]', true %> WiFi
          </div>
        </div>
      </div>

      <hr class="my-4">

      <h5>I would like to exhibit:</h5>

      <div class="row">
        <div class="col">
          <div class="form-check">
            <%= check_box_tag 'q[is_adverts_eq]', true %> Advertisement
          </div>

          <div class="form-check">
            <%= check_box_tag 'q[is_drawings_eq]', true %> Drawings
          </div>

          <div class="form-check">
            <%= check_box_tag 'q[is_live_perf_eq]', true %> Live Performance
          </div>
        </div>
        <div class="col">
          <div class="form-check">
            <%= check_box_tag 'q[is_paintings_eq]', true %> Paintings
          </div>

          <div class="form-check">
            <%= check_box_tag 'q[is_photography_eq]', true %> Photography
          </div>

          <div class="form-check">
            <%= check_box_tag 'q[is_sculptures_eq]', true %> Scultpures
          </div>
        </div>
      </div>

      <hr class="my-4">

      <%= f.submit "Search", class:"btn btn-primary" %>

    <% end %>
  </div>

  <div class="col-md-6">
    <%= render 'search_map' %>
  </div>
</div>

<hr>

<div class="row">
  <div class="card-columns">
    <% @arrSpaces.each do |space| %>

      <div class="card">
        <% if space.images.attached? %>
          <%= link_to image_tag(space.images[0], class:"card-img"), space %>
        <% end %>
        <div class="card-body">
          <h5 class="card-title"><%= space.listing_name %></h5>
          <p class="card-text"><%= space.venue_type %></p>
          <p class="card-text small">
            Price: Â£ <%= space.price %> per day<br>
            <%= space.category %><br>
            <%= space.wall_width %> x <%= space.wall_height %> cm<br>
            <small class="text-muted">Hosted by <%= link_to space.user.display_name, space.user, class:"text-muted" %></small>
          </p>
        </div>
      </div>

    <% end %>
  </div>
</div>

<script>
	$(function() {
		$("#start_date").datepicker({
			dateFormat: 'dd-mm-yy',
			minDate: 0,
			maxDate: '3m',
			onSelect: function(selected) {
				$('#end_date').datepicker("option", "minDate", selected);
				$('#end_date').attr('disabled', false);
			}
		});

		$("#end_date").datepicker({
			dateFormat: 'dd-mm-yy',
			minDate: 0,
			maxDate: '3m',
			onSelect: function(selected) {
				$('#start_date').datepicker("option", "maxDate", selected);
			}
		});
	})
</script>
